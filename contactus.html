<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact Us</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="assets/js/config.js"></script>
  <script src="assets/js/auth.js"></script>
  <script src="assets/js/database.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #111;
      color: #fff;
    }

    .contact-section {
      padding: 50px 20px;
    }

    /* Heading + intro text */
    .contact-header {
      text-align: center;
      margin-bottom: 50px; /* gap below lorem text */
    }

    .contact-header h2 {
      font-size: 32px;
      margin-bottom: 15px; /* gap between heading and lorem */
    }

    .contact-header p {
      font-size: 16px;
      color: #ccc;
      margin: 0;
    }

    /* Layout for address + form */
    .contact-container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 50px;
      flex-wrap: wrap;
    }

    /* Left side (address, phone, email) */
    .contact-info {
      max-width: 300px;
    }

    .contact-info h3 {
      color: #00bfff;
      margin-bottom: 8px;
    }

    .contact-info p {
      margin-bottom: 20px;
      line-height: 1.6;
    }

    /* Right side (form) */
    .contact-form {
      background: #fff;
      color: #000;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      width: 350px;
    }

    .contact-form h3 {
      margin-bottom: 20px;
    }

    .contact-form input,
    .contact-form textarea {
      width: 100%;
      border: none;
      border-bottom: 1px solid #aaa;
      margin-bottom: 20px;
      padding: 10px;
      font-size: 14px;
      outline: none;
    }

    .contact-form textarea {
      resize: none;
      height: 80px;
    }

    .contact-form button {
      width: 100%;
      padding: 12px;
      background: #00bfff;
      border: none;
      color: #fff;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .contact-form button:hover {
      background: #0099cc;
    }

    .success-message {
      background: #28a745;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      text-align: center;
      font-weight: bold;
      display: none;
    }

    .error-message {
      background: #dc3545;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      text-align: center;
      font-weight: bold;
      display: none;
    }
  </style>
</head>
<body>

  <section class="contact-section">
    <!-- Heading + lorem text -->
    <div class="contact-header">
      <h2>Contact Us</h2>
      <p>"From First Step to Center Stage"</p>
    </div>

    <!-- Address + Form -->
    <div class="contact-container">
      <!-- Left side -->
      <div class="contact-info">
        <h3>Address</h3>
        <p>Valo Dance Academy
No. 28, 2nd Floor, 12th Main Road,
HAL 9th Stage, Indiranagar,
Bengaluru, Karnataka<br> – 560038</p>

        <h3>Phone</h3>
        <p>91 98765 43210</p>

        <h3>Email</h3>
        <p>contact@valodanceacademy.com</p>
      </div>

      <!-- Right side -->
      <div class="contact-form">
        <h3>Send Message</h3>
        <form id="contactForm" onsubmit="handleContactSubmit(event)">
          <input type="text" id="fullName" placeholder="Full Name" required>
          <input type="email" id="email" placeholder="Email" required>
          <textarea id="message" placeholder="Type your Message..." required></textarea>
          <button type="submit" id="submitBtn">Send</button>
        </form>
        
        <div id="successMessage" class="success-message">
          ✅ Thank you! Your message has been sent successfully. We'll get back to you soon!
        </div>
        
        <div id="errorMessage" class="error-message">
          ❌ Sorry, there was an error sending your message. Please try again.
        </div>
      </div>
    </div>
  </section>

  <script>
    // Handle contact form submission
    async function handleContactSubmit(event) {
      event.preventDefault();
      
      const form = document.getElementById('contactForm');
      const submitBtn = document.getElementById('submitBtn');
      const successMessage = document.getElementById('successMessage');
      const errorMessage = document.getElementById('errorMessage');
      
      // Get form data
      const name = document.getElementById('fullName').value.trim();
      const email = document.getElementById('email').value.trim();
      const message = document.getElementById('message').value.trim();
      
      // Validation
      if (!name || !email || !message) {
        showErrorMessage('Please fill in all fields');
        return;
      }
      
      if (!isValidEmail(email)) {
        showErrorMessage('Please enter a valid email address');
        return;
      }
      
      // Show loading state
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Sending...';
      submitBtn.disabled = true;
      
      // Hide previous messages
      successMessage.style.display = 'none';
      errorMessage.style.display = 'none';
      
      try {
        // Store the message using database manager
        const result = await window.databaseManager.storeContactMessage(name, email, message);
        
        if (result.success) {
          // Show success message
          successMessage.style.display = 'block';
          
          // Clear form
          form.reset();
          
          // Log the storage method
          console.log(`Message stored via: ${result.method}`);
          
          // Auto-hide success message after 5 seconds
          setTimeout(() => {
            successMessage.style.display = 'none';
          }, 5000);
        } else {
          showErrorMessage('Failed to send message. Please try again.');
        }
      } catch (error) {
        console.error('Contact form error:', error);
        showErrorMessage('An error occurred. Please try again later.');
      } finally {
        // Reset button state
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
      }
    }
    
    // Show error message
    function showErrorMessage(message) {
      const errorMessage = document.getElementById('errorMessage');
      errorMessage.textContent = message;
      errorMessage.style.display = 'block';
      
      // Auto-hide error message after 5 seconds
      setTimeout(() => {
        errorMessage.style.display = 'none';
      }, 5000);
    }
    
    // Email validation
    function isValidEmail(email) {
      const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
      return emailRegex.test(email);
    }
  </script>

</body>
</html>
